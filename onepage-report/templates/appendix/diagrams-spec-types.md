# diagrams-spec 附錄：圖表類型詳細規範

> **載入條件：** 當需要產生特定類型圖表的詳細內容時載入此檔案

---

## 1. before_after（前後對比）- 主圖首選

適用：改善效果、問題解決前後對比

### 內容描述格式

```markdown
### 圖表內容

**左側區塊「改善前」**（紅色邊框 #F44336，淺灰背景 #F5F5F5）：
- 標題：改善前：{具體問題名稱}
- 內部流程：
  1. {具體步驟名稱}
     - 說明：{這步驟做什麼}
     - 問題：{這裡有什麼問題}（用紅色標示）
     - 數據：{相關數據，如延遲時間}
  2. {下一個步驟}...
- 用紅色虛線標出問題發生的位置

**右側區塊「改善後」**（綠色邊框 #4CAF50，淺灰背景 #F5F5F5）：
- 標題：改善後：{改善方案名稱}
- 內部流程同上，用綠色標示改善的部分

**中間連接**：
- 虛線箭頭從左區塊指向右區塊
- 箭頭上方標註：「導入 {方案名稱}」
- 下方標註：「效果：{具體改善數據}」

**底部總結**：
- 加入對比數據表格或重點總結
```

---

## 2. platform_compare（平台對比）

適用：PC vs 手機、不同平台機制對照

### 內容描述格式

```markdown
### 圖表內容

**上方區塊「PC 平台」**（藍色邊框 #2196F3）：
- 標題：PC 平台：{機制名稱}
- 完整流程（橫向）：
  1. [{步驟1名稱}]
     └ {具體做什麼}
  → 2. [{步驟2名稱}]
     └ {具體做什麼}
  → 3. [{結果}]
- 每個節點內要有 2-3 行說明

**下方區塊「手機平台」**（藍色邊框 #2196F3）：
- 標題：手機平台：{機制名稱}
- 完整流程同上，用不同顏色標示跟 PC 不同的步驟

**差異標註**（用橙色虛線 #FF9800）：
- 連接兩平台的對應步驟
- 每個差異點都要有說明文字

**右側或底部總結區**：
- 關鍵差異列表
- 為什麼手機要用不同做法
```

---

## 3. flow（流程圖）

適用：單一流程、步驟說明、機制運作

### 內容描述格式

```markdown
### 圖表內容

**節點序列**（藍色圓角矩形 #2196F3）：

1. [{開始：觸發條件}]
   ├ 觸發方式：{什麼情況會觸發}
   └ 輸入：{需要什麼輸入}

   ↓ {條件或數據}

2. [{步驟1名稱}]
   ├ 動作：{具體做什麼}
   └ 耗時：{時間}

   ↓ {輸出什麼}

3. [{結果}]
   └ 效果：{達成什麼效果}

**連接方式**：
- 節點間用實線箭頭連接
- 箭頭上標註：條件、數據、或輸出內容
- 如有分支，要畫出判斷菱形和多條路徑
```

---

## 4. timeline（時間軸/延遲鏈路）

適用：延遲分析、時序關係、Input-to-Display 鏈路

### 內容描述格式

```markdown
### 圖表內容

**時間軸線**：水平線貫穿整張圖，標註總時間

**事件節點**（沿時間軸分佈）：

1. [{起點事件}]（粉紅色 #E91E63）
   ├ 時間點：T=0
   └ 說明：{發生什麼}

   ──[{階段1名稱}: {時間}ms]──→

2. [{中間事件}]（灰色）
   ├ 時間點：T={累計時間}
   └ 說明：{發生什麼}

3. [{終點事件}]（綠色 #4CAF50）
   ├ 時間點：T={總時間}
   └ 說明：{最終結果}

**時間標註**：
- 每個箭頭上標註該階段的時間
- 用紅色標示瓶頸階段
- 底部加入時間總結
```

---

## 5. architecture（系統架構圖）- 附錄必須

適用：展示整體系統架構、模組關係、本次改動位置

### 內容描述格式

```markdown
### 圖表內容

**整體佈局**：分層架構（上到下）

**分層結構**：

┌─────────────────────────────────────────────────┐
│  應用層 (Application Layer)                      │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐       │
│  │ 遊戲App  │  │ 系統UI   │  │ 其他App  │       │
│  └──────────┘  └──────────┘  └──────────┘       │
└─────────────────────────────────────────────────┘
                      ↓ API 呼叫
┌─────────────────────────────────────────────────┐
│  框架層 (Framework Layer)                        │
│  ┌──────────┐  ┌──────────────────┐             │
│  │ Surface  │  │ 本次改動模組     │ ← 用顏色標示 │
│  │ Flinger  │  │ (詳細說明)       │             │
│  └──────────┘  └──────────────────┘             │
└─────────────────────────────────────────────────┘

**標示要求**：
- 用橙色或紅色邊框標示本次改動的模組
- 加上「本次改動」標籤
- 說明改動內容
- 標註資料流向和 API 呼叫關係
```

---

## 顏色參考

| 用途 | 顏色 | Hex |
|------|------|-----|
| 問題/改善前 | 紅色 | #F44336 |
| 解決/改善後 | 綠色 | #4CAF50 |
| 一般節點 | 藍色 | #2196F3 |
| 差異標示 | 橙色 | #FF9800 |
| 背景 | 淺灰 | #F5F5F5 |
| 強調區塊 | 粉紅 | #E91E63 |
| 次要元素 | 灰色 | #9E9E9E |
