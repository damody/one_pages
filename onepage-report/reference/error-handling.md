# 錯誤處理

## SVG 生成失敗

如果 subagent 生成 SVG 失敗（僅適用於 DIAGRAM_METHOD = svg_png）：

1. 檢查 SVG 生成指示是否清晰完整
2. 確認尺寸欄位格式正確（如 1056x528）
3. 如果仍失敗，簡化圖表內容後重試
4. 若持續失敗，建議用戶改選 PPTX Shapes 方式重新執行

---

## PPTX 渲染失敗

如果 render_this.py 執行失敗：

1. 檢查錯誤訊息
2. 修正程式碼後重新執行
3. 如果多次失敗，使用簡化佈局

### 常見錯誤與解法

| 錯誤類型 | 可能原因 | 解決方式 |
|----------|----------|----------|
| ImportError | 缺少 python-pptx 套件 | `pip install python-pptx` |
| FileNotFoundError | 圖片路徑錯誤 | 確認 .png 檔案存在 |
| ValueError | 位置或尺寸參數無效 | 檢查 Inches() 參數是否為正數 |
| cairosvg 錯誤 | SVG 語法錯誤 | 檢查 SVG 是否有 emoji 或不支援的元素 |

---

## 素材不足

如果素材中缺少必要資訊：

1. 在審稿階段指出缺少什麼
2. 請使用者補充
3. 不可憑空捏造數據

### 處理策略

| 缺少內容 | 處理方式 |
|----------|----------|
| 缺少數字 | 使用「約」「估計」等修飾詞，或請使用者補充 |
| 缺少來源 | 標註「待補充來源」，在 Issue List 中指出 |
| 缺少背景 | 使用 WebSearch 查證，或請使用者補充 |
| 缺少結論支撐 | 弱化結論，加上「初步」「在特定條件下」 |

---

## 內容過多

如果內容太多無法放入一頁：

1. **不可刪減內容**
2. 縮小字體（最小 8pt，極端情況 7pt）
3. 調整佈局（如雙欄）
4. 分多頁（主報告 + 詳細說明頁）

---

## 術語過多

如果術語標記 `[[術語]]` 過多：

1. 考慮用白話文改寫部分術語
2. 合併相關術語的解釋
3. 確保附錄投影片能容納所有術語

---

## 排版重疊

如果排版審查發現重疊：

### 修正優先順序

1. 調整位置（移動元素）
2. 縮減間距
3. 縮減內容
4. 縮小字體

### 重疊偵測失敗

如果無法自動偵測重疊：
1. 手動檢查生成的 PPTX
2. 根據視覺檢查結果調整 render_this.py
3. 重新執行
